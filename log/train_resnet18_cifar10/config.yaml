data:
  batch_size: 16
  dataset: imagenet
  downsample: true
  num_workers: 12
  root: ./data/imagenet
  train_split: train
  val_split: val
eval:
  batch_size: 256
  max_macs: 1
  n_branches: 4096
model:
  branch_enc:
    attn_pdrop: 0.1
    embd_dim: 256
    embd_type: 0
    eos: false
    n_heads: 4
    n_layers: 5
    out_dim: 128
    path_pdrop: 0.1
    pe_type: 0
    proj_pdrop: 0.1
    seq_len: 15
  branch_vae:
    hid_dim: 64
    in_dim: 15
    latent_dim: 4
    n_layers: 3
  content_enc:
    arch: resnet10_imagenet
    out_dim: 128
    pretrained: false
  resnet:
    arch: resnet50
    dataset: imagenet
opt:
  branch_enc:
    lr: 0.001
    optim_type: adamw
    sched_type: cosine
    weight_decay: 0.05
  branch_vae:
    gamma: 0.1
    lr: 0.001
    optim_type: adam
    sched_type: multistep
    steps:
    - 8
    weight_decay: 0
  clip_grad_norm: 1.0
  content_enc:
    lr: 0.001
    optim_type: adamw
    sched_type: cosine
    weight_decay: 0.05
  epochs: 9
  warmup:
  - branch_enc
  - content_enc
  warmup_epochs: 1
seed: 1234567891
train:
  bce_loss: 0.0
  bce_weight: 0.0
  delta_rs: 0.5
  k: 1
  min_n_positives: 8
  n_branches: 64
  rank_weight: 1.0
  sort_weight: 0.0
  temperature: 10
  vae_batch_size: 128
